CHARMM Element doc/rxncons.doc $Revision: 1.2 $

File: Rxncons, Node: Top, Up: (chmdoc/commands.doc), Next: Sytax 

Rxncons: Commands for holonomic constrains of different order parameters

Author: Jhih-Wei Chu, June 30, 2007
Email : jwchu@berkeley.edu

The commands described in this node are associated with the holonomic
constraints of several order parameters that may be used to study the
reactions of biomolecules. Current implementation includes 4 kinds of
order parameters.

1. BDIS, keeps the difference between the lengths of two connected bonds 
         at the designated value   
2. BOND, keeps the distance between two particles at the designated value   
3. PCNS, keeps the distances (can be rms best fit distances) of 
         a structure between two other reference structures equal
4. PATH, keeps the distances (can be rms best fit distances) between replicas 
         equal to each other, replicas need to be generated by using 
         the replica command first, see replica.doc to replicate a system
         into many copies.

* Menu:
* Syntax::		Syntax of the rxncons commands
* Usage::	 	Description of command usage
* Implementation::	A brief description of the anatomy of RCONstraint
* Restrictions:: 	Restrictions on usage	
* Examples:: 		Supplementary examples of the use of RCONstraint


File: Rxncons, Node: Syntax, Up: Top, Next: Usage, Previous: Top

Syntax of RCONstaint commands 

[SYNTAX: RCONstaint commands]

RCONstraint { [BDIS repeat(3x(atom-spec)) ] [RXNC real] [PLAG] -
                                         [IUNL integer] [MAXIter integer] }
            { [BOND repeat(2x(atom-spec)) ] [RXNC real] [PLAG] -
                                         [IUNL integer] [MAXIter integer] }
            { [PCNS]                        [RXNC real] [PLAG] -
                                         [IUNL integer] [MAXIter integer] }
            {                      [NOTRanslation] [NOROtation] -
                                          [MASS] [WEIG] [MAXIter integer] }
            { [PATH]              [PLAG] [IUNL integer] [MAXIter integer] }
            {                   [CYCLic] [NOTRanslation] [NOROtation] -
                                          [MASS] [WEIG] [MAXIter integer] }
            { [CLEAn] [type]                                              }

Keyword    Purpose
 
BIDS       Keeps the difference between the lengths of two connected bonds
           at the designated value

BOND       Keeps the distance between two particles at the designated value.

PCNS       Keeps the distances (can be rms best fit distances) of
           a structure between two other reference structures equal.
           One of the refernce structure will be read from the COMP array,
           and the other will be read from the REF array. The scalar command
           may be used to copy coordinates to these arrays. Also see the
           examples.

PATH       Keeps the distances (can be rms best fit distances) between replicas
           equal to each other, replicas need to be generated by using the
           replica command first, see replica.doc to replica a system to many
           copies.

RXNC       The value of the constraned order parameter.
           The default value is 0.0 for BDIS.
           Negative or zero value will cause error in BOND.

PLAG       Flag to active the output of the lagrange multipliers that are
           requires to satisfy the constraint during a dynamic simulation
           (dynamc.src).
           In addition, the Z and G factors as defined in Sprik M, Ciccotti G
           "Free energy from constrained molecular dynamics" 
           JOURNAL OF CHEMICAL PHYSICS 109 (18): 7737-7744 NOV 8 1998
           will also be recorded in PLAG is specificed. 

IUNL       Unit for outputing the lagrange multiplers. Frequency of the output
           is NSACC (see dynamc.doc).

MAXI       Maximium allowable steps of iterations for solving the nonlinear 
           algebraic equation(s) of the constraint.

CYCL       Specifies that a path is cyclic

NOTR       Calculate the distances between replicas WITHOUT overlaying their
           centers.

NORO       Calculate the distances between replicas WITHOUT doing rotational
           best fit 

MASS       Use mass weighted distance.

WEIG       Use wmain array to weight the atoms of each replica.

CLEA       Clean up the pointers of the constraints. Should be called after
           RCONS is no longer used.

atom-spec:==		(see *note select:(chmdoc/select.doc).)


File: Rxncons, Node: Usage, Up: Top, Next: Implementation, Previous: Syntax
	
Description of RCONStraint command usage

This command treats ONE selected reaction coordinate (order parameter) as a
holonomic constraint. Currently, only one reaction coordinate is allowed.
Generalization to multiplie reaction coordinates will be implemented in the
future. 

This command is included as part of the holonomic constraints that are
involved in CHARMM, such as SHAKE, LONEpair, etc. In other words,
the subroutines of RCON are called from HOLONOM.SRC

The BDIS constraint fixes the difference between two connected bonds at
the value specified to RXNC. Only THREE atoms are allowed to be chosen,
since the two bonds are connected.

The BOND constraint fixes the distance between two particles at the value
(must be positive) specified to RXNC. 

The PCNS constraint keeps the distances (can be rms best fit distances) 
of a structure between two other reference structures equal. This constraint 
can be used to sample the configuration space on the hyperplane that is 
in the middle between two reference structures. The reference structures may 
be obtained by different methods, such as the  replica/path or nudeged 
elastic band method (see replica.doc). The averaged forces that are required 
to maintain the constraints of this type along a reference path can be used 
to compute the potential of mean force along this path.

The PATH constraint keeps the distances (can be rms best fit distances) 
between replicas equal to each other, replicas need to be generated by using 
the replica command first, see replica.doc to replica a system into many
copies. This constraint is able to avoid the sliding down and corner-cutting
problems of the replica/path method without doing force projections as in
nudged elastic band or the string methods, and the results are thus more
reliable.


File: RCONstraint, Node: Restrictions, Up: Top, Next: Examples, Previous: Implementation

Restrictions

The holonomic constraints in CHARMM are not fully integrated and there may be
problems if all types of holonomic constraints are present. This needs to be
fixed.

Only one reaction coordinate is allowed in the current implementation.
Generalization to multiple reaction coordinates is under development.

Other types of order parameters may be implemented. Seggestions are welcome;
please send suggestions to jwchu@berkeley.edu

No lagrange multipliers will be output for the PATH constraint. It is not
recommended to run dynamics with the PATH constraint at this point.


File: RCONS, Node: Examples, Up: Top, Next: , Previous: Restrictions

Supplementary examples.

1. The BDIS constraint 
 
RCON BDIS rxnc 0.0 sele bynu 8 end sele bynu 3 .or. bynu 11 end iunl 66

will keep ( distance between atom 8 and 3 ) - ( distance between 3 and 11 )
at 0.0 lagrange multiplers will be output to file with unit 66

2. The bond constraint

RCON BOND plag rxnc 11.0 sele bynu 3 end sele bynu 11 end iunl 66

will keep the distance between atom 3 and 11 at the value of 11.0 A.
lagrange multiplers will be output to file with unit 66

3. The plane constraint  

 open read card unit 44 name a.crd
 read coor unit 44 ignore comp
 close unit 44

 scalar xref = xcomp
 scalar yref = ycomp
 scalar zref = zcomp

 open read card unit 44 name b.crd
 read coor unit 44 ignore comp
 close unit 44

RCON PCNS rxnc 0.0 plag weig iunl 66

will keep the system at the same distance to a.crd and to b.crd 
the weighting array will be used to calcualte the weighted distance
lgrange multiplers will be output to file with unit 66

4. The reaction path constratint

RCON PATH rxnc 0.0 plag cycl mass

will keep the distances between the replicas of a cyclic path equal.
The distances will be mass weighted.

See also
rxncons.inp
rxncons_rpath.inp
